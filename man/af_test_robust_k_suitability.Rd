% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/af_trick_of_the_tail.R
\name{af_test_robust_k_suitability}
\alias{af_test_robust_k_suitability}
\title{Test Suitability of Robust K Factor Across Survey Waves}
\usage{
af_test_robust_k_suitability(
  df,
  extremism_var,
  wave_var = NULL,
  k_factor = 1.5,
  method = c("MAD", "Sn", "Qn", "Tau"),
  min_tail_size = 80,
  min_unique_values = 5,
  moderate_threshold = 0.75,
  suggest_optimal = TRUE,
  k_range = seq(1, 2.5, 0.1)
)
}
\arguments{
\item{df}{Data frame containing the survey data}

\item{extremism_var}{Character string. Name of the variable containing extremism scores}

\item{wave_var}{Character string. Name of the variable containing wave identifiers (optional)}

\item{k_factor}{Numeric value for the robust multiplier to test (default: 2.5)}

\item{method}{Character string: "MAD", "Qn", "Sn", or "Tau" (default: "Qn")}

\item{min_tail_size}{Minimum acceptable tail sample size (default: 80)}

\item{min_unique_values}{Minimum acceptable number of unique values in tail (default: 5, set to NULL to disable)}

\item{moderate_threshold}{Percentile below which values are considered "moderate" (default: 0.75, set to NULL to disable)}

\item{suggest_optimal}{Logical. Whether to suggest optimal K factors for unsuitable waves (default: TRUE)}

\item{k_range}{Numeric vector. Range of K factors to test when suggesting optimal (default: seq(1.5, 4.0, 0.1))}
}
\value{
Data frame with detailed results for each wave
}
\description{
This function evaluates whether a specific K factor for robust scale estimators
produces suitable tail definitions across survey waves by checking:
\enumerate{
\item Adequate sample sizes in tails
\item Sufficient unique values in tails
\item Exclusion of moderate values from tails (optional)
\item Consistency across waves
}
}
\examples{
# Example with simulated multi-wave data
df <- data.frame(
  wave = rep(c("Wave1", "Wave2", "Wave3"), each = 1000),
  extremism = c(rnorm(1000, 2, 1), rbeta(1000, 2, 5) * 6 + 1, rnorm(1000, 3, 1.5))
)

results <- af_test_robust_k_suitability(df, "extremism", "wave", k_factor = 2.5)
print(results)

}
