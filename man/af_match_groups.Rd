% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/af_events.R
\name{af_match_groups}
\alias{af_match_groups}
\title{Perform Multi-Group Propensity Score Matching}
\usage{
af_match_groups(
  df,
  treatment_var,
  covariate_vars,
  outcome_var,
  wave_var,
  caliper = 0.1,
  method = "nearest",
  seed = 12345,
  balance_metrics = c("smd", "var_ratio"),
  balance_threshold = 0.1,
  var_ratio_threshold = c(0.5, 2),
  min_group_size = 100,
  required_treatment_levels = NULL
)
}
\arguments{
\item{df}{Data frame containing the variables}

\item{treatment_var}{Character, name of treatment variable (must have at least 2 levels)}

\item{covariate_vars}{Named list of covariate variables to match on (e.g., list(age = "age_col", gender = "gender_col"))}

\item{outcome_var}{Character, name of outcome variable}

\item{wave_var}{Character, name of wave identifier variable}

\item{caliper}{Numeric, maximum propensity score difference for matching (default: 0.1)}

\item{method}{Character, matching method (default: "nearest")}

\item{seed}{Integer, random seed for reproducibility (default: 12345)}

\item{balance_metrics}{Character vector, balance assessment metrics (default: c("smd", "var_ratio"))}

\item{balance_threshold}{Numeric, acceptable standardized mean difference threshold (default: 0.1)}

\item{var_ratio_threshold}{Numeric vector, acceptable variance ratio bounds (default: c(0.5, 2.0))}

\item{min_group_size}{Integer, minimum required observations per treatment group (default: 100)}

\item{required_treatment_levels}{Character vector, expected treatment levels (default: NULL, auto-detect)}
}
\value{
List containing:
\item{matched_data}{Data frame with matched observations ready for analysis}
\item{matchit_object}{MatchIt object with technical matching details}
\item{balance_plot}{Love plot showing balance before/after matching}
\item{quality_metrics}{Named numeric vector with matching quality indicators}
}
\description{
This function performs multi-group propensity score matching using nearest neighbor
algorithm with equal representation from all treatment groups. For N treatment groups,
it creates matched sets with one individual from each group (1:1:1:...:1 ratio).
It can be used to match any categorical treatment variable with 2 or more levels
(e.g., political orientation, religiosity, education level, etc.) on specified covariates.
}
\examples{
# Political orientation matching (3 groups) - creates 1:1:1 matched triplets
covars <- list(religiosity = "relig", gender = "gender", age_group = "age_grp")
result <- af_match_groups(df, "political_orient", covars, "extremism", "wave")

# Religiosity matching (6 groups) - creates 1:1:1:1:1:1 matched sextuplets
covars <- list(political_orient = "pol_orient", gender = "gender", age_group = "age_grp")
result <- af_match_groups(df, "religiosity", covars, "extremism", "wave")

# Education level matching (4 groups) - creates 1:1:1:1 matched quartets
covars <- list(income = "income_cat", region = "region", age_group = "age_grp")
result <- af_match_groups(df, "education", covars, "outcome", "time_period")

}
